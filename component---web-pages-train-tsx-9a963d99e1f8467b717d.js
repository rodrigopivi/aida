(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{105:function(e,t,n){"use strict";var r;function i(){var e=function(e,t){t||(t=e.slice(0));return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n    text-align: center;\n    font-size: 19px;\n"]);return i=function(){return e},e}Object.defineProperty(t,"__esModule",{value:!0}),t.Logo=t.ColoredText=void 0,n(109);var o=((r=n(85))&&r.__esModule?r:{default:r}).default.div.withConfig({displayName:"Logo__ColoredText",componentId:"sc-1ib5m8j-0"})(["font-weight:bold;color:#1890ff;display:inline-block;text-decoration:none;background-image:linear-gradient(to right,#1890ff 25%,#c4ce35 50%,#ac24e2 75%,#1890ff 100%);-webkit-text-fill-color:transparent;-webkit-background-clip:text;background-clip:text;background-size:300% auto;&.static{background-position:-215% center;}&.animated{@keyframes text-gradient{to{background-position:-300% center;}}animation:text-gradient 16s ease-in-out infinite;}"]);t.ColoredText=o;var a=o.extend(i());t.Logo=a},107:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return i.createElement(o.default,{key:"helmet",title:"Aida",meta:[{name:"description",content:"Build amazing conversational experiences"},{content:"aida, chatito, chatbots, ai chatbots, nlu, nlp, natural language processing, tensorflowjs, keras, named entity recognition, text classification",name:"keywords"}]},i.createElement("link",{rel:"shortcut icon",href:"/favicon.ico"}),i.createElement("link",{rel:"apple-touch-icon",sizes:"180x180",href:"/apple-touch-icon.png"}),i.createElement("link",{rel:"icon",type:"image/png",sizes:"32x32",href:"/favicon-32x32.png"}),i.createElement("link",{rel:"icon",type:"image/png",sizes:"16x16",href:"/favicon-16x16.png"}),i.createElement("link",{rel:"manifest",href:"/site.webmanifest"}),i.createElement("link",{rel:"mask-icon",href:"/safari-pinned-tab.svg",color:"#5bbad5"}),i.createElement("meta",{name:"msapplication-TileColor",content:"#da532c"}),i.createElement("meta",{name:"theme-color",content:"#fcfcfc"}),i.createElement("meta",{name:"viewport",content:"initial-scale=1.0, width=device-width"}))};var r,i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(n(0)),o=(r=n(156))&&r.__esModule?r:{default:r}},116:function(e,t,n){var r;e.exports=(r=n(117))&&r.default||r},117:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=c(n(0)),i=c(n(2)),o=c(n(24)),a=c(n(3));function c(e){return e&&e.__esModule?e:{default:e}}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var s=function(e){var t=e.location,n=a.default.getResourcesForPathnameSync(t.pathname);return r.default.createElement(o.default,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){l(e,t,n[t])})}return e}({location:t,pageResources:n},n.json))};s.propTypes={location:i.default.shape({pathname:i.default.string.isRequired}).isRequired};var u=s;t.default=u},128:function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(176);var i=f(n(177));n(145);var o=f(n(84));n(184);var a=f(n(185));n(109);var c=f(n(86)),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(n(0)),s=f(n(85)),u=n(105);function f(e){return e&&e.__esModule?e:{default:e}}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var y=a.default.Header,g=a.default.Content,b=a.default.Footer,v=/^\/overview(\/.*)?$/i,w=/^\/demo(\/.*)?$/i,O=/^\/train(\/.*)?$/i,P=(0,s.default)(g).withConfig({displayName:"Layout__StyledContent",componentId:"sc-11gw4mw-0"})(["> p{text-align:justify;}background:#fcfcfc;padding:48px 48px 48px 72px;min-height:280px;"]),E=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),p(this,m(t).apply(this,arguments))}var n,r,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(t,l.Component),n=t,(r=[{key:"render",value:function(){var e="-1";return v.test(this.props.location.pathname)?e="0":w.test(this.props.location.pathname)?e="1":O.test(this.props.location.pathname)&&(e="2"),l.createElement(a.default,{style:{minHeight:"100vh"}},l.createElement(y,{style:{background:"#fcfcfc",padding:0,display:"flex"}},l.createElement(u.Logo,{style:{textAlign:"right",width:200,paddingLeft:24,paddingRight:24},className:"static"},l.createElement(c.default,{to:"/"},"< Aida />")),l.createElement("div",{style:{flex:1}}),l.createElement("div",{style:{padding:"0 48px 0 24px",display:"inline-block",textAlign:"right",float:"right"}},l.createElement("a",{href:"https://github.com/rodrigopivi/aida",title:"Aida",style:{fontSize:26}},l.createElement(o.default,{type:"github"})))),l.createElement(a.default,{style:{flexDirection:"row"}},l.createElement(a.default.Sider,{width:200,breakpoint:"lg",collapsedWidth:"0",theme:"light",style:{backgroundColor:"#fcfcfc"}},l.createElement(i.default,{theme:"light",mode:"inline",defaultSelectedKeys:[e],style:{background:"#fcfcfc"}},l.createElement(i.default.Item,{key:"0"},l.createElement(c.default,{to:"/overview"},l.createElement(o.default,{type:"right-circle-o"}),"Overview")),l.createElement(i.default.Item,{key:"1"},l.createElement(c.default,{to:"/demo"},l.createElement(o.default,{type:"right-circle-o"}),"Demo")),l.createElement(i.default.Item,{key:"2"},l.createElement(c.default,{to:"/train"},l.createElement(o.default,{type:"right-circle-o"}),"Train your own")))),l.createElement(a.default,{style:{padding:"24px 0 0 24px"}},l.createElement(P,null,this.props.children),l.createElement(b,{style:{textAlign:"center"}},"Aida © 2018 Rodrigo Pimentel"))))}}])&&d(n.prototype,r),s&&d(n,s),t}();t.default=E},164:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.graphql=function(){throw new Error("It appears like Gatsby is misconfigured. Gatsby related `graphql` calls are supposed to only be evaluated at compile time, and then compiled away,. Unfortunately, something went wrong and the query was left in the compiled code.\n\n.Unless your site has a complex or custom babel/Gatsby configuration this is likely a bug in Gatsby.")},Object.defineProperty(t,"Link",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"withPrefix",{enumerable:!0,get:function(){return o.withPrefix}}),Object.defineProperty(t,"navigate",{enumerable:!0,get:function(){return o.navigate}}),Object.defineProperty(t,"push",{enumerable:!0,get:function(){return o.push}}),Object.defineProperty(t,"replace",{enumerable:!0,get:function(){return o.replace}}),Object.defineProperty(t,"navigateTo",{enumerable:!0,get:function(){return o.navigateTo}}),Object.defineProperty(t,"waitForRouteChange",{enumerable:!0,get:function(){return a.waitForRouteChange}}),Object.defineProperty(t,"PageRenderer",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(t,"parsePath",{enumerable:!0,get:function(){return l.default}}),t.StaticQuery=t.StaticQueryContext=void 0;var r=s(n(0)),i=s(n(2)),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(n(86)),a=n(22),c=s(n(116)),l=s(n(23));function s(e){return e&&e.__esModule?e:{default:e}}var u=r.default.createContext({});t.StaticQueryContext=u;var f=function(e){return r.default.createElement(u.Consumer,null,function(t){return e.data||t[e.query]&&t[e.query].data?(e.render||e.children)(e.data?e.data.data:t[e.query].data):r.default.createElement("div",null,"Loading (StaticQuery)")})};t.StaticQuery=f,f.propTypes={data:i.default.object,query:i.default.string.isRequired,render:i.default.func,children:i.default.func}},174:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PipelineModel=void 0;t.PipelineModel=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}},264:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AidaPipeline=t.defaultPipelineDefinition=void 0;var r=l(n(265)),i=l(n(266)),o=n(267),a=l(n(271)),c=l(n(272));function l(e){return e&&e.__esModule?e:{default:e}}function s(e,t,n,r,i,o,a){try{var c=e[o](a),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,i)}function u(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var o=e.apply(t,n);function a(e){s(o,r,i,a,c,"next",e)}function c(e){s(o,r,i,a,c,"throw",e)}a(void 0)})}}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d={config:{classification:{epochs:5,filterSizes:[2,4,8],lowConfidenceThreshold:.3,numFilters:128},default:{batchSize:120,drop:.5,embeddingDimensions:300,lossThresholdToStopTraining:1e-6,maxNgrams:20,trainingValidationSplit:.3},ner:{addAttention:!0,epochs:5,lowConfidenceThreshold:.2,numFilters:[128,128],rnnUnits:100}}};t.defaultPipelineDefinition=d;t.AidaPipeline=function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),f(this,"pipelineDefinition",d),f(this,"datasetParams",void 0),f(this,"embeddingsModel",void 0),f(this,"classificationModel",void 0),f(this,"nerModel",void 0),f(this,"logger",void 0),f(this,"tokenizer",void 0),f(this,"train",(p=u(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.logger.log("START TRAINING PIPELINE MODELS!"),n.logger.log("=================================================================================================="),e.next=4,n.classificationModel.train(t);case 4:return e.next=6,n.nerModel.train(t);case 6:n.logger.log("FINISHED TRAINING PIPELINE MODELS!"),n.logger.log("==================================================================================================");case 8:case"end":return e.stop()}},e,this)})),function(e){return p.apply(this,arguments)})),f(this,"test",(s=u(regeneratorRuntime.mark(function e(t){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.logger.log("START TESTING PIPELINE MODELS!"),n.logger.log("=================================================================================================="),e.next=4,n.classificationModel.test(t);case 4:return r=e.sent,e.next=7,n.nerModel.test(t);case 7:return i=e.sent,e.abrupt("return",{classificationStats:r,nerStats:i});case 9:case"end":return e.stop()}},e,this)})),function(e){return s.apply(this,arguments)})),f(this,"predict",function(e){var t=n.classificationModel.predict(e);return{classification:t,ner:n.nerModel.predict(e,t)}}),f(this,"save",(l=u(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.logger.log("SAVING PIPELINE MODELS!"),n.logger.log("=================================================================================================="),e.next=4,n.classificationModel.tfModel().save(t.classificationPath);case 4:return e.next=6,n.nerModel.tfModel().save(t.nerPath);case 6:return e.next=8,n.embeddingsModel.tfModel().save(t.embeddingPath);case 8:case"end":return e.stop()}},e,this)})),function(e){return l.apply(this,arguments)})),t.pipelineDefinition&&(this.pipelineDefinition=t.pipelineDefinition),this.datasetParams=t.datasetParams,this.logger=t.logger,this.tokenizer=function(e){var t=e?e.toLowerCase():e;if("en"===t)return r.default;if("es"===t)return i.default;throw new Error("Invalid config language. Only 'en' and 'es' are supported.")}(this.datasetParams.language),this.embeddingsModel=new o.EmbeddingsModel(t.ngramToIdDictionary,t.datasetParams.maxWordsPerSentence,this.pipelineDefinition.config.default.maxNgrams,this.pipelineDefinition.config.default.embeddingDimensions,this.tokenizer,t.pretrainedEmbedding,t.pretrainedNGramVectors);var l;var s;var p;var m,h,y=Object.assign({},this.pipelineDefinition.config.default,this.pipelineDefinition.config.classification);t.trainStatsHandler&&(m=t.trainStatsHandler.classification,h=t.trainStatsHandler.ner),this.classificationModel=new a.default(y,this.datasetParams,this.embeddingsModel,this.logger,t.pretrainedClassifier,m);var g=Object.assign({},this.pipelineDefinition.config.default,this.pipelineDefinition.config.ner);this.nerModel=new c.default(g,this.datasetParams,this.embeddingsModel,this.logger,t.pretrainedNer,h)}},265:function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=new function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),r(this,"FILTER_CHARS_REGEXP",/[^a-z0-9\.,\?\'"!@#\$%\^&\*\(\)-_=\+;:<>\/\\\|\}\{\[\]`~ ]/gi),r(this,"WORD_SEPARATORS_REGEXP",/([\ \.\,\%\*\-\=\+\;\|\`\~])/g),r(this,"NON_ALPHANUMERIC_REGEXP",/[^a-z0-9]/gi),r(this,"UNKNOWN_NGRAM_KEY","__"),r(this,"NUMBERS_MAP",{zero:"0",one:"1",two:"2",three:"3",four:"4",five:"5",six:"6",seven:"7",eight:"8",nine:"9"}),r(this,"sanitizeSentence",function(e){return e.trim().toLowerCase().replace(t.FILTER_CHARS_REGEXP,"")}),r(this,"splitSentenceToWords",function(e){return t.sanitizeSentence(e).split(t.WORD_SEPARATORS_REGEXP).map(function(e){return e.trim()}).filter(function(e){return!!e})}),r(this,"splitWordToBiGrams",function(e){var t=[],n=e.length-2+1;if(n<1)return t;for(;n--;)t[n]=e.substr(n,2);return t}),r(this,"joinWordsToSentence",function(e){return e.join(" ")})};t.default=i},266:function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=new function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),r(this,"FILTER_CHARS_REGEXP",/[^aábcdeéfghijklmnñoópqrstuúüvwxyzAÁBCDEÉFGHIJKLMNÑOÓPQRSTUÚÜVWXYZ 0-9\.,\?\'"!@#\$%\^&\*\(\)-_=\+;:<>\/\\\|\}\{\[\]`~]/g),r(this,"WORD_SEPARATORS_REGEXP",/([\ \.\,\%\*\-\=\+\;\|\`\~])/g),r(this,"NON_ALPHANUMERIC_REGEXP",/[^aábcdeéfghijklmnñoópqrstuúüvwxyzAÁBCDEÉFGHIJKLMNÑOÓPQRSTUÚÜVWXYZ0-9]/g),r(this,"UNKNOWN_NGRAM_KEY","__"),r(this,"NUMBERS_MAP",{cero:"0",uno:"1",dos:"2",tres:"3",cuatro:"4",cinco:"5",seis:"6",siete:"7",ocho:"8",nueve:"9"}),r(this,"sanitizeSentence",function(e){return e.trim().toLowerCase().replace(t.FILTER_CHARS_REGEXP,"")}),r(this,"splitSentenceToWords",function(e){return t.sanitizeSentence(e).split(t.WORD_SEPARATORS_REGEXP).map(function(e){return e.trim()}).filter(function(e){return!!e})}),r(this,"splitWordToBiGrams",function(e){var t=[],n=e.length-3+1;if(n<1)return t;for(;n--;)t[n]=e.substr(n,3);return t}),r(this,"joinWordsToSentence",function(e){return e.join(" ")})};t.default=i},267:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmbeddingsModel=void 0;var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(n(89)),i=n(268),o=n(270);function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l=function(){var e,t,n;function l(e,t,n,i,o,a,s){var u=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),c(this,"tokenizer",void 0),c(this,"ngramToIdDictionary",void 0),c(this,"maxWords",void 0),c(this,"maxNgrams",void 0),c(this,"embeddingDimensions",void 0),c(this,"model",void 0),c(this,"inputModel",null),c(this,"tfModel",function(){return u.model}),c(this,"modelInput",function(){if(!u.inputModel){var e=r.layers.input({shape:[u.maxWords,u.maxNgrams],dtype:"int32"}),t=u.model.apply(e);u.inputModel=r.model({inputs:e,outputs:t})}return u.inputModel}),c(this,"embed",function(e){return r.tidy(function(){var t=u.sentencesToWordIds(e),n=u.modelInput().predictOnBatch(t);return t.dispose(),n})}),c(this,"dictionary",function(){return u.ngramToIdDictionary}),c(this,"sentencesToWordIds",function(e){return r.tidy(function(){var t=e.map(function(e){return u.tokenizer.splitSentenceToWords(e)}),n=r.buffer([e.length,u.maxWords,u.maxNgrams],"int32");return t.forEach(function(e,t){e.forEach(function(e,r){void 0!==u.ngramToIdDictionary[e]?n.set(u.ngramToIdDictionary[e],t,r,0):e.length&&u.generateWordIdsFromNGrams(e).forEach(function(i,o){o>u.maxNgrams?console.warn("Word exceeding max n grams per word: ",e):n.set(i,t,r,o)})})}),n.toTensor()})}),c(this,"generateWordIdsFromNGrams",function(e){var t=[],n=function(e){return void 0!==u.ngramToIdDictionary[e]&&(t.push(u.ngramToIdDictionary[e]),!0)};if(e.length>2){var r=!0;if(u.tokenizer.splitWordToBiGrams(e).forEach(function(e){!n(e)&&r&&(r=!1)}),r)return t}return t=[],e.split("").forEach(n),t}),this.ngramToIdDictionary=e,this.maxWords=t,this.maxNgrams=n,this.embeddingDimensions=i,this.model=a||l.setupModel(s||new Map,this.maxWords,this.maxNgrams,this.embeddingDimensions),this.tokenizer=o}return e=l,n=[{key:"setupModel",value:function(e,t,n,a){var c=r.sequential(),l=r.layers.embedding({embeddingsInitializer:new o.PreSavedEmbeddingsInitializer({embeddingDimensions:a,pretrainedNGramVectors:e}),inputDim:e.size,inputLength:[n],maskZero:!0,outputDim:a,trainable:!1});return c.add(r.layers.timeDistributed({layer:l,inputShape:[t,n]})),c.add(new i.CombineNgramsLayer({})),c}}],(t=null)&&a(e.prototype,t),n&&a(e,n),l}();t.EmbeddingsModel=l},268:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CombineNgramsLayer=void 0;var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(n(89)),i=n(384);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var f=function(e){function t(){var e,n,r,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,l=new Array(a),f=0;f<a;f++)l[f]=arguments[f];return r=this,n=!(i=(e=c(t)).call.apply(e,[this].concat(l)))||"object"!==o(i)&&"function"!=typeof i?s(r):i,u(s(s(n)),"className",t.className),n}var n,f,d;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(t,r.layers.Layer),n=t,(f=[{key:"computeOutputShape",value:function(e){return[e[0],e[1],e[e.length-1]]}},{key:"call",value:function(e,t){var n=this;return r.tidy(function(){n.invokeCallHook(e,t);var o=r.sum(e,2),a=(0,i.l2Normalize)(o,2);return o.dispose(),a})}}])&&a(n.prototype,f),d&&a(n,d),t}();t.CombineNgramsLayer=f,u(f,"className","CombineNgramsLayer"),r.serialization.SerializationMap.register(f)},270:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PreSavedEmbeddingsInitializer=void 0;var r=a(n(89)),i=a(n(388)),o=n(155);function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var m=function(e){function t(e){var n,r,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,n=!(i=u(t).call(this))||"object"!==c(i)&&"function"!=typeof i?d(r):i,p(d(d(n)),"config",void 0),p(d(d(n)),"className",t.className),n.config=e,n}var n,a,m;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(t,i.Initializer),n=t,(a=[{key:"apply",value:function(e,t){var n=this;return this.config&&this.config.pretrainedNGramVectors?r.tidy(function(){var e=(0,o.flatMapDeep)(l(n.config.pretrainedNGramVectors.values()));return r.tensor2d(e,[n.config.pretrainedNGramVectors.size,n.config.embeddingDimensions],"float32")}):r.zeros(e,t)}},{key:"getConfig",value:function(){return this.config.pretrainedNGramVectors}}])&&s(n.prototype,a),m&&s(n,m),t}();t.PreSavedEmbeddingsInitializer=m,p(m,"className","PreSavedEmbeddingsInitializer"),r.serialization.SerializationMap.register(m)},271:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(89)),i=n(155),o=a(n(174));function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function s(e,t,n,r,i,o,a){try{var c=e[o](a),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,i)}function u(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var o=e.apply(t,n);function a(e){s(o,r,i,a,c,"next",e)}function c(e){s(o,r,i,a,c,"throw",e)}a(void 0)})}}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var y=function(e){var t,n,a;function s(e,t,n,o,a,d){var p,y,g;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),y=this,g=f(s).call(this),p=!g||"object"!==c(g)&&"function"!=typeof g?m(y):g,h(m(m(p)),"config",void 0),h(m(m(p)),"datasetParams",void 0),h(m(m(p)),"model",void 0),h(m(m(p)),"embeddingsModel",void 0),h(m(m(p)),"logger",void 0),h(m(m(p)),"classificationTrainStatsHandler",void 0),h(m(m(p)),"tfModel",function(){return p.model}),h(m(m(p)),"predict",function(e){var t=[];return r.tidy(function(){var n=p.embeddingsModel.embed(e),r=p.model.predict(n),i=r.dataSync();r.dispose(),n.dispose();var o=p.datasetParams.intents;e.forEach(function(e,n){var r=i.slice(n*o.length,n*o.length+o.length),a=[];r.forEach(function(t,n){return a.push({confidence:t,intent:o[n],sentence:e})}),a.sort(function(e,t){return e.confidence>t.confidence?-1:1}),t.push(a[0])})}),t}),h(m(m(p)),"train",function(){var e=u(regeneratorRuntime.mark(function e(t){var n,o,a,c,s,u,f,d,m,h,y,g,b,v,w,O,P;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=(0,i.chunk)(t.trainY,p.config.batchSize),o=(0,i.chunk)(t.trainX,p.config.batchSize),p.logger.log("Start training classification model!"),a=p.model,c=!1,s=!0,u=!1,f=void 0,e.prev=8,d=o.entries()[Symbol.iterator]();case 10:if(s=(m=d.next()).done){e.next=34;break}if(h=l(m.value,2),y=h[0],g=h[1],!c){e.next=14;break}return e.abrupt("return");case 14:return b=p.embeddingsModel.embed(g),v=r.tensor1d(n[y],"int32"),w=r.oneHot(v,p.datasetParams.intents.length),e.next=19,a.fit(b,w,{callbacks:{onBatchEnd:r.nextFrame},epochs:p.config.epochs,shuffle:!0,validationSplit:p.config.trainingValidationSplit});case 19:v.dispose(),b.dispose(),w.dispose(),O=a.history.history,P=O.val_loss.length-1,p.classificationTrainStatsHandler&&p.classificationTrainStatsHandler({batch:y+1,batchEpochs:a.history.epoch.length,currentBatchSize:o[y].length,tensorsInMemory:r.memory().numTensors,totalBatches:o.length,trainingAccuracy:O.acc[P],trainingLoss:O.loss[P],validationAccuracy:O.val_acc[P],validationLoss:O.val_loss[P]}),p.logger.log("Trained ".concat(a.history.epoch.length," epochs on batch ").concat(y+1," of ").concat(o.length)),p.logger.log("Training Loss: ".concat(O.loss[P]," | Training Accuracy: ").concat(O.acc[P])),p.logger.log("Validation Loss: ".concat(O.val_loss[P]," | Validation Accuracy: ").concat(O.val_acc[P])),p.logger.warn("(Memory) Number of tensors in memory at the end of batch: ".concat(r.memory().numTensors)),p.logger.log("=================================================================================================="),p.config.lossThresholdToStopTraining&&O.loss[P]<p.config.lossThresholdToStopTraining&&O.val_loss[P]<p.config.lossThresholdToStopTraining&&(c=!0,p.logger.warn("Enough accuracy reached! Ending training after batch ".concat(y+1," of ").concat(o.length)),p.logger.log("=================================================================================================="));case 31:s=!0,e.next=10;break;case 34:e.next=40;break;case 36:e.prev=36,e.t0=e.catch(8),u=!0,f=e.t0;case 40:e.prev=40,e.prev=41,s||null==d.return||d.return();case 43:if(e.prev=43,!u){e.next=46;break}throw f;case 46:return e.finish(43);case 47:return e.finish(40);case 48:case"end":return e.stop()}},e,this,[[8,36,40,48],[41,,43,47]])}));return function(t){return e.apply(this,arguments)}}()),h(m(m(p)),"test",function(){var e=u(regeneratorRuntime.mark(function e(t,n){var r,o,a,c,s,u,f,d,m,h,y,g,b;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(r=n||p.defaultResultsLogger,o={correct:0,wrong:0,lowConfidence:0},a=(0,i.chunk)(t.testX,p.config.batchSize),c=(0,i.chunk)(t.testY,p.config.batchSize),s=!0,u=!1,f=void 0,e.prev=7,d=a.entries()[Symbol.iterator]();!(s=(m=d.next()).done);s=!0)h=l(m.value,2),y=h[0],g=h[1],b=p.predict(g),r(g,c[y],b,o);e.next=15;break;case 11:e.prev=11,e.t0=e.catch(7),u=!0,f=e.t0;case 15:e.prev=15,e.prev=16,s||null==d.return||d.return();case 18:if(e.prev=18,!u){e.next=21;break}throw f;case 21:return e.finish(18);case 22:return e.finish(15);case 23:return e.abrupt("return",o);case 24:case"end":return e.stop()}},e,this,[[7,11,15,23],[16,,18,22]])}));return function(t,n){return e.apply(this,arguments)}}()),h(m(m(p)),"defaultResultsLogger",function(e,t,n,r){return e.forEach(function(e,i){var o=p.datasetParams.intents[t[i]],a=n[i].intent===o;if(n[i].confidence<p.config.lowConfidenceThreshold){if(void 0===r.lowConfidence)return;r.lowConfidence++,p.logger.warn("LOW CONFIDENCE (intent: ".concat(n[i].intent,", confidence: ").concat(n[i].confidence,") - ").concat(e))}else a?(r.correct++,p.logger.debug("CORRECT (intent: ".concat(n[i].intent,", confidence: ").concat(n[i].confidence,") - ").concat(e))):(r.wrong++,p.logger.error("WRONG (intent: ".concat(n[i].intent,", confidence: ").concat(n[i].confidence,") - ").concat(e)))}),r}),p.config=e,p.datasetParams=t,p.embeddingsModel=n,p.model=a||s.setup(p.config,p.datasetParams),p.logger=o,p.classificationTrainStatsHandler=d,p}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(s,o.PipelineModel),t=s,a=[{key:"setup",value:function(e,t){var n=t.maxWordsPerSentence,i=t.intents.length,o=r.train.adam(.0066,.0025,.1),a=r.input({dtype:"float32",shape:[n,e.embeddingDimensions],name:"embedded_words"}),c=r.layers.conv1d({activation:"relu",filters:e.numFilters,inputShape:[n,e.embeddingDimensions],kernelInitializer:"randomNormal",kernelSize:[e.filterSizes[0]],name:"classConv1",padding:"valid"}).apply(a),l=r.layers.maxPooling1d({padding:"valid",poolSize:n-e.filterSizes[0]+1}).apply(c),s=r.layers.conv1d({activation:"relu",filters:e.numFilters,inputShape:[n,e.embeddingDimensions],kernelInitializer:"randomNormal",kernelSize:[e.filterSizes[1]],name:"classConv2",padding:"valid"}).apply(a),u=r.layers.maxPooling1d({padding:"valid",poolSize:n-e.filterSizes[1]+1}).apply(s),f=r.layers.conv1d({activation:"relu",filters:e.numFilters,inputShape:[n,e.embeddingDimensions],kernelInitializer:"randomNormal",kernelSize:[e.filterSizes[2]],name:"classConv3",padding:"valid"}).apply(a),d=r.layers.maxPooling1d({padding:"valid",poolSize:n-e.filterSizes[2]+1}).apply(f),p=r.layers.concatenate({axis:1}).apply([l,u,d]),m=r.layers.flatten().apply(p),h=r.layers.dropout({rate:e.drop}).apply(m),y=r.layers.flatten().apply(l),g=r.layers.concatenate({axis:1}).apply([h,y]),b=r.layers.dense({activation:"softmax",units:i}).apply(g),v=r.model({inputs:a,outputs:b});return v.compile({loss:"categoricalCrossentropy",metrics:["accuracy"],optimizer:o}),v}}],(n=null)&&d(t.prototype,n),a&&d(t,a),s}();t.default=y},272:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=c(n(89)),i=n(155),o=c(n(174)),a=n(273);function c(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t,n,r,i,o,a){try{var c=e[o](a),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,i)}function f(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var o=e.apply(t,n);function a(e){u(o,r,i,a,c,"next",e)}function c(e){u(o,r,i,a,c,"throw",e)}a(void 0)})}}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var g=function(e){var t,n,c;function u(e,t,n,o,a,c){var p,m,g;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),m=this,g=d(u).call(this),p=!g||"object"!==s(g)&&"function"!=typeof g?h(m):g,y(h(h(p)),"config",void 0),y(h(h(p)),"datasetParams",void 0),y(h(h(p)),"model",void 0),y(h(h(p)),"embeddingsModel",void 0),y(h(h(p)),"logger",void 0),y(h(h(p)),"nerTrainStatsHandler",void 0),y(h(h(p)),"tfModel",function(){return p.model}),y(h(h(p)),"rawPrediction",function(e,t){return r.tidy(function(){var n=p.datasetParams,o=n.maxWordsPerSentence,a=n.slotsToId,c=Object.keys(a).length,l=p.embeddingsModel.embed(e),s=t.map(function(e){var t=new Array(p.datasetParams.intents.length).fill(0),n=p.datasetParams.intents.indexOf(e.intent);return-1!==n&&(t[n]=1),t}),u=(0,i.flatMapDeep)(s),f=r.tensor2d(u,[s.length,p.datasetParams.intents.length]),d=p.model.predict([f,l]),m=d.dataSync();return d.dispose(),f.dispose(),l.dispose(),(0,i.chunk)(m,o*c).map(function(e){return(0,i.chunk)(e,c)}).map(function(e){return e.map(function(e){var t=0,n=e.length?e[t]:0;return e.forEach(function(r,i){e[t]<r&&(t=i,n=r)}),{highestIndex:t,confidence:n}})})})}),y(h(h(p)),"predict",function(e,t){var n=p.config.lowConfidenceThreshold,r=p.datasetParams.slotsToId,i=p.rawPrediction(e,t);return e.map(function(e,t){var o=i[t],a=p.embeddingsModel.tokenizer.splitSentenceToWords(e);return a.reduce(function(t,i,c){t.current&&0===t.current.confidence&&(t.current.confidence=o[c].confidence);var l=Object.keys(r).find(function(e){return o[c]&&r[e]===o[c].highestIndex});return l&&t.current?(t.current.key!==l?(t.current.key&&"O"!==t.current.key&&t.current.confidence>=n&&(t.slots[t.current.key]||(t.slots[t.current.key]=[]),t.slots[t.current.key].push({confidence:t.current.confidence,value:t.current.value})),t.current={confidence:o[c].confidence,key:l,value:i}):(t.current.value+=" ".concat(i),t.current.confidence=(o[c].confidence+t.current.confidence)/2),c+1===a.length?("O"!==t.current.key&&t.current.confidence>=n&&(t.slots[t.current.key]||(t.slots[t.current.key]=[]),t.slots[t.current.key].push({confidence:t.current.confidence,value:t.current.value})),{sentence:e,slots:t.slots}):t):t},{current:{key:"",value:"",confidence:0},slots:{},sentence:""})})}),y(h(h(p)),"train",function(){var e=f(regeneratorRuntime.mark(function e(t){var n,o,a,c,u,f,d,m,h,y,g,b,v,w,O;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=(0,i.chunk)(t.trainY2,p.config.batchSize),o=(0,i.chunk)(t.trainY,p.config.batchSize),a=(0,i.chunk)(t.trainX,p.config.batchSize),c=p.config,u=c.epochs,f=c.trainingValidationSplit,d=Object.keys(p.datasetParams.slotsToId).length,p.logger.log("Start training NER model!"),m=!1,h=!0,y=!1,g=void 0,e.prev=10,b=regeneratorRuntime.mark(function e(){var t,i,c,s,h,y,g,b,v;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=l(w.value,2),i=t[0],c=t[1],!m){e.next=3;break}return e.abrupt("return",{v:void 0});case 3:return s=r.tidy(function(){return r.oneHot(r.tensor1d(o[i],"int32"),p.datasetParams.intents.length).asType("float32")}),h=p.embeddingsModel.embed(c),y=r.tidy(function(){var e=[],t=!0,o=!1,a=void 0;try{for(var c,l=n[i][Symbol.iterator]();!(t=(c=l.next()).done);t=!0){var s=c.value,u=r.tensor1d(s,"int32").pad([[0,p.datasetParams.maxWordsPerSentence-s.length]]),f=r.oneHot(u,d).asType("float32");u.dispose(),e.push(f)}}catch(e){o=!0,a=e}finally{try{t||null==l.return||l.return()}finally{if(o)throw a}}var m=r.stack(e);return e.forEach(function(e){return e.dispose()}),m}),e.next=8,p.model.fit([s,h],y,{callbacks:{onBatchEnd:r.nextFrame},epochs:u,shuffle:!0,validationSplit:f});case 8:return s.dispose(),h.dispose(),e.next=12,r.nextFrame();case 12:g=p.model.history.history,b=g.val_loss.length-1,v=p.model.history.epoch,p.nerTrainStatsHandler&&p.nerTrainStatsHandler({batch:i+1,batchEpochs:v.length,currentBatchSize:a[i].length,tensorsInMemory:r.memory().numTensors,totalBatches:a.length,trainingAccuracy:g.acc[b],trainingLoss:g.loss[b],validationAccuracy:g.val_acc[b],validationLoss:g.val_loss[b]}),p.logger.log("Trained ".concat(v.length," epochs on batch ").concat(i+1," of ").concat(a.length)),p.logger.log("Training Loss: ".concat(g.loss[b]," | Training Accuracy: ").concat(g.acc[b])),p.logger.log("Validation Loss: ".concat(g.val_loss[b]," | Validation Accuracy: ").concat(g.val_acc[b])),p.logger.warn("(Memory) Number of tensors in memory at the end of batch: ".concat(r.memory().numTensors)),p.logger.log("=================================================================================================="),y.dispose(),p.config.lossThresholdToStopTraining&&g.loss[b]<p.config.lossThresholdToStopTraining&&g.val_loss[b]<p.config.lossThresholdToStopTraining&&(m=!0,p.logger.warn("Enough accuracy reached! Ending training after batch ".concat(i+1," of ").concat(a.length)),p.logger.log("=================================================================================================="));case 23:case"end":return e.stop()}},e,this)}),v=a.entries()[Symbol.iterator]();case 13:if(h=(w=v.next()).done){e.next=21;break}return e.delegateYield(b(),"t0",15);case 15:if("object"!==s(O=e.t0)){e.next=18;break}return e.abrupt("return",O.v);case 18:h=!0,e.next=13;break;case 21:e.next=27;break;case 23:e.prev=23,e.t1=e.catch(10),y=!0,g=e.t1;case 27:e.prev=27,e.prev=28,h||null==v.return||v.return();case 30:if(e.prev=30,!y){e.next=33;break}throw g;case 33:return e.finish(30);case 34:return e.finish(27);case 35:case"end":return e.stop()}},e,this,[[10,23,27,35],[28,,30,34]])}));return function(t){return e.apply(this,arguments)}}()),y(h(h(p)),"test",function(){var e=f(regeneratorRuntime.mark(function e(t,n){var o,a,c,s,u,f,d,m,h,y,g,b;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:o=n||p.defaultResultsLogger,a={correct:0,wrong:0},c=p.config.batchSize,s=(0,i.chunk)(t.testX,c),u=(0,i.chunk)(t.testY,c),f=(0,i.chunk)(t.testY2,c),d=!0,m=!1,h=void 0,e.prev=9,y=regeneratorRuntime.mark(function e(){var t,n,i,c,s,d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=l(b.value,2),n=t[0],i=t[1],c=u[n],s=i.map(function(e,t){return{confidence:1,intent:p.datasetParams.intents[c[t]],sentence:e}}),d=p.rawPrediction(i,s).map(function(e){return e.map(function(e){return e.highestIndex})}),o(i,f[n],d,a),e.next=7,r.nextFrame();case 7:case"end":return e.stop()}},e,this)}),g=s.entries()[Symbol.iterator]();case 12:if(d=(b=g.next()).done){e.next=17;break}return e.delegateYield(y(),"t0",14);case 14:d=!0,e.next=12;break;case 17:e.next=23;break;case 19:e.prev=19,e.t1=e.catch(9),m=!0,h=e.t1;case 23:e.prev=23,e.prev=24,d||null==g.return||g.return();case 26:if(e.prev=26,!m){e.next=29;break}throw h;case 29:return e.finish(26);case 30:return e.finish(23);case 31:return e.abrupt("return",a);case 32:case"end":return e.stop()}},e,this,[[9,19,23,31],[24,,26,30]])}));return function(t,n){return e.apply(this,arguments)}}()),y(h(h(p)),"defaultResultsLogger",function(e,t,n,r){return e.forEach(function(e,i){var o=t[i],a=n[i],c=!0;o.forEach(function(e,t){a[t]!==e&&c&&(c=!1)}),c?(r.correct++,p.logger.debug("CORRECT - ".concat(e," expected: ").concat(o,", predicted: ").concat(a))):(r.wrong++,p.logger.error("WRONG - ".concat(e," expected: ").concat(o,", predicted: ").concat(a)))}),r}),p.config=e,p.datasetParams=t,p.embeddingsModel=n,p.model=a||u.setup(p.config,p.datasetParams),p.logger=o,p.nerTrainStatsHandler=c,p}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}(u,o.PipelineModel),t=u,c=[{key:"setup",value:function(e,t){var n=t.maxWordsPerSentence,i=e.addAttention,o=e.embeddingDimensions,c=e.numFilters,l=e.rnnUnits,s=Object.keys(t.slotsToId).length,u=r.train.adam(.0066,.0025,.1),f=r.input({dtype:"float32",shape:[n,o],name:"embedded_words"}),d=r.layers.conv1d({activation:"relu",filters:c[0],inputShape:[n,o],kernelInitializer:"randomNormal",kernelSize:1,name:"nerConv1",padding:"valid"}).apply(f),p=r.layers.conv1d({activation:"relu",filters:c[0],kernelInitializer:"randomNormal",kernelSize:1,name:"nerConv2",padding:"valid"}).apply(d),m=r.input({dtype:"float32",shape:[t.intents.length],name:"embedded_intent"}),h=r.layers.repeatVector({n}).apply(m),y=r.layers.concatenate().apply([h,f,p]),g=r.layers.bidirectional({layer:r.layers.lstm({units:l,returnSequences:!0,name:"bidi_encoder"})}).apply(y),b=null;if(i){var v=new a.TimeSeriesAttention({name:"attention_weight"}).apply(g[0]);b=r.layers.concatenate().apply([v,g[0],g[1]])}else b=r.layers.concatenate().apply([g[0],g[1]]);var w=r.layers.dense({activation:"softmax",units:s}).apply(b),O=r.model({inputs:[m,f],outputs:w});return O.compile({loss:"categoricalCrossentropy",metrics:["accuracy"],optimizer:u}),O}}],(n=null)&&p(t.prototype,n),c&&p(t,c),u}();t.default=g},273:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TimeSeriesAttention=void 0;var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(n(89)),i=n(389);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var f=function(e){function t(e){var n,r,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,n=!(a=c(t).call(this,e||{}))||"object"!==o(a)&&"function"!=typeof a?s(r):a,u(s(s(n)),"className",t.className),u(s(s(n)),"timed",null),n.inputSpec=[new i.InputSpec({ndim:3})],n.supportsMasking=!0,n}var n,f,d;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(t,r.layers.Layer),n=t,(f=[{key:"build",value:function(e){var t=e[2],n=r.sequential({name:"per_time_step"});n.add(r.layers.dense({inputShape:[t],kernelInitializer:"zeros",units:t,activation:"softmax",name:"att_dense1"})),n.add(r.layers.dense({units:t,kernelInitializer:"glorotNormal",activation:"tanh",name:"att_dense2"})),this.timed=r.layers.timeDistributed({layer:n,name:"att_td"}),this.timed.build(e),this.trainableWeights=this.timed.trainableWeights,this.nonTrainableWeights=this.timed.nonTrainableWeights,this.built=!0}},{key:"call",value:function(e,t){var n=this;if(!this.built||!this.timed)throw new Error("Calling TimeSeriesAttention layer before it was built correctly.");return r.tidy(function(){n.invokeCallHook(e,t);var i=n.timed.apply(e),o=r.layers.permute({dims:[2,1]}).apply(i),a=r.unstack(e[0]),c=r.unstack(o),l=a.map(function(e,t){return r.dot(e,c[t])}),s=r.stack(l),u=r.softmax(s),f=r.layers.permute({dims:[2,1]}).apply(u),d=r.unstack(f).map(function(e,t){return r.dot(e,a[t])});return r.stack(d)})}},{key:"computeOutputShape",value:function(e){return e}}])&&a(n.prototype,f),d&&a(n,d),t}();t.TimeSeriesAttention=f,u(f,"className","TimeSeriesAttention"),r.serialization.SerializationMap.register(f)},274:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(124);var r=l(n(118));n(125);var i=l(n(119));n(165);var o=l(n(166));n(248);var a=l(n(390)),c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(n(0));function l(e){return e&&e.__esModule?e:{default:e}}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var h=(0,l(n(85)).default)(a.default.Search).withConfig({displayName:"TrainedPipelineTestInput__SearchInput",componentId:"sc-17hlu7-0"})(["> input{padding-right:70px !important;}"]),y=function(e){function t(){var e,n,r,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];return r=this,i=(e=f(t)).call.apply(e,[this].concat(a)),n=!i||"object"!==s(i)&&"function"!=typeof i?p(r):i,m(p(p(n)),"state",{disabled:!1,outTextContent:null}),m(p(p(n)),"renderIntentsList",function(){return c.createElement("div",null,c.createElement("p",null,"The pipeline was trained on this list of intents and slots per intent:"),c.createElement("div",null,c.createElement("ul",null,c.createElement("li",null,"greet"),c.createElement("li",null,"bye"),c.createElement("li",null,"affirmative"),c.createElement("li",null,"negative"),c.createElement("li",null,"wtf (detect insults and out of context stuff)"),c.createElement("li",null,"playMusic -> slots: artist, song"),c.createElement("li",null,"addEventToCalendar -> slots: calendarEvent, dateTime"))),c.createElement("p",null,"You can try a sentence like 'please remind to me watch real madrid match tomorrow at 9pm' or 'play new york new york from frank sinatra'"),c.createElement("p",null,"Check the"," ",c.createElement("a",{target:"_blank",href:"https://github.com/rodrigopivi/aida/tree/master/typescript/intents"},"chatito definition files at the github repo"),"  for more details about the training examples generation."))}),m(p(p(n)),"predict",function(e){var t=n.props.pipeline.predict([e]);return Object.assign({},t.classification[0],t.ner[0])}),m(p(p(n)),"handleSubmit",function(e){if(!e||!e.trim())return null;n.setState({disabled:!0},function(){var t=JSON.stringify(n.predict(e),null,2);n.setState({outTextContent:t},function(){n.setState({disabled:!1});var e=document.getElementById("__inputSearch");e&&e.value&&(e.value="")})})}),n}var n,a,l;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(t,c.Component),n=t,(a=[{key:"render",value:function(){return c.createElement("div",null,c.createElement(r.default,{type:"flex",justify:"center"},c.createElement(i.default,{span:24,sm:{span:12}},c.createElement(o.default,{title:"Test trained pipeline:",style:{minHeight:"100%"}},c.createElement("p",null,c.createElement(h,{placeholder:"Enter some input to process...",enterButton:"Send",size:"large",onSearch:this.handleSubmit,id:"__inputSearch",disabled:this.state.disabled})),this.renderIntentsList())),c.createElement(i.default,{span:24,sm:{span:12}},c.createElement(o.default,{title:"Pipeline output:",style:{minHeight:"100%"}},c.createElement("pre",{style:{marginTop:"2em"}},this.state.outTextContent||"")))))}}])&&u(n.prototype,a),l&&u(n,l),t}();t.default=y},342:function(e,t){},343:function(e,t){},362:function(e,t){},365:function(e,t){},58:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(n(0)),i=c(n(107)),o=c(n(128)),a=c(n(831));function c(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var t=e.location;return r.createElement(o.default,{location:t,style:{minHeight:"95vh"}},r.createElement(i.default,null),r.createElement(a.default,null))}},831:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(124);var r=d(n(118));n(165);var i=d(n(166));n(199);var o=d(n(200));n(335);var a=d(n(336));n(125);var c=d(n(119)),l=d(n(378)),s=n(86),u=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(n(0)),f=d(n(832));function d(e){return e&&e.__esModule?e:{default:e}}function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m(e,t,n,r,i,o,a){try{var c=e[o](a),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,i)}function h(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var o=e.apply(t,n);function a(e){m(o,r,i,a,c,"next",e)}function c(e){m(o,r,i,a,c,"throw",e)}a(void 0)})}}function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e,t){return(b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function v(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function w(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var O=function(e){function t(){var e,n,r,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];return r=this,i=(e=g(t)).call.apply(e,[this].concat(a)),n=!i||"object"!==p(i)&&"function"!=typeof i?v(r):i,w(v(v(n)),"state",{datasetParams:null,datasetTest:null,datasetTraining:null,downloadProgress:0,embeddingsAndTrainingDatasetLoaded:!1,isDownloading:!1,ngramToIdDictionary:null,pretrainedNGramVectors:null}),w(v(v(n)),"renderIntentsList",function(){return u.createElement("div",null,u.createElement("p",null,"The pipeline is going to start training on this list of intents and slots:"),u.createElement("div",null,u.createElement("ul",null,u.createElement("li",null,"greet"),u.createElement("li",null,"bye"),u.createElement("li",null,"affirmative"),u.createElement("li",null,"negative"),u.createElement("li",null,"wtf (detect insults and out of context stuff)"),u.createElement("li",null,"playMusic -> slots: artist, song"),u.createElement("li",null,"addEventToCalendar -> slots: calendarEvent, dateTime"))),u.createElement("p",null,"Check the"," ",u.createElement("a",{target:"_blank",href:"https://github.com/rodrigopivi/aida/tree/master/typescript/intents"},"chatito definition files at the github repo"),"  for more details about the training examples generation."))}),w(v(v(n)),"downloadFiles",function(){var e=h(regeneratorRuntime.mark(function e(t){var r,i,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=0,i=0,n.setState({isDownloading:!0,downloadProgress:0}),e.next=5,Promise.all(t.map(function(e){return l.default.get(e,{onDownloadProgress:function(e){var t=e.lengthComputable?e.total:e.target.getResponseHeader("content-length")||e.target.getResponseHeader("x-decompressed-content-length");null!==t&&(r+=t,i+=Math.round(100*e.loaded/r)),n.setState({downloadProgress:i})}})}));case 5:return o=e.sent,n.setState({isDownloading:!1,downloadProgress:100}),e.abrupt("return",o);case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()),w(v(v(n)),"timeoutInMs",function(){var e=h(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e){return setTimeout(e,t)}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()),w(v(v(n)),"trainTestAndSaveModels",h(regeneratorRuntime.mark(function e(){var t,r,i,o,a,c,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=[(0,s.withPrefix)("/models/dictionary.json"),(0,s.withPrefix)("/models/ngram_to_id_dictionary.json"),(0,s.withPrefix)("/models/dataset_params.json"),(0,s.withPrefix)("/models/dataset_training.json"),(0,s.withPrefix)("/models/dataset_testing.json")],e.next=3,n.downloadFiles(t);case 3:return r=e.sent,i=new Map(r[0].data),o=r[1].data,a=r[2].data,c=r[3].data,l=r[4].data,e.next=11,n.timeoutInMs(200);case 11:n.setState({datasetParams:a,datasetTest:l,datasetTraining:c,embeddingsAndTrainingDatasetLoaded:!0,ngramToIdDictionary:o,pretrainedNGramVectors:i});case 12:case"end":return e.stop()}},e,this)}))),n}var n,d,m;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}(t,u.Component),n=t,(d=[{key:"render",value:function(){var e=this.state,t=e.embeddingsAndTrainingDatasetLoaded,n=e.datasetParams,l=e.datasetTraining,s=e.datasetTest,d=e.ngramToIdDictionary,p=e.pretrainedNGramVectors;if(t&&n&&l&&s&&d&&p)return u.createElement(f.default,{datasetParams:n,trainDataset:l,testDataset:s,ngramToIdDictionary:d,pretrainedNGramVectors:p});var m=this.state.isDownloading||100===this.state.downloadProgress,h=m?100===this.state.downloadProgress?"Loading...":"Downloading...":"Start training";return u.createElement(r.default,{type:"flex"},u.createElement(c.default,{span:24,sm:{span:12}},u.createElement("h2",null,"Train your model from scratch"),u.createElement("p",null,"The pipeline is composed of two trainable models. Text classification model determines the intent of a sentence, named entity recognition model extracts the slots. Once the training finishes, will run the test dataset on them and give you a report, finally your browser will ask you to accept the download of the trained model files."),this.renderIntentsList(),u.createElement("p",null,"Click 'start training' to continue.")),u.createElement(c.default,{span:24,sm:{span:12}},u.createElement(i.default,{style:{marginLeft:"2em",textAlign:"center"}},u.createElement("div",null,u.createElement(a.default,{type:"circle",percent:this.state.downloadProgress})),u.createElement("br",null),u.createElement("div",null,u.createElement(o.default,{type:"primary",size:"large",disabled:m,onClick:this.trainTestAndSaveModels},h)),u.createElement("br",null),u.createElement("p",null,"Will download the embeddings dictionary (about 1mb), generate the dataset, then train and test the models. This process may take several minutes to complete, you will get feedback of the progress but the webpage might feel unresponsive while training."))))}}])&&y(n.prototype,d),m&&y(n,m),t}();t.default=O},832:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(124);var r=h(n(118));n(125);var i=h(n(119));n(833);var o=h(n(836));n(165);var a=h(n(166));n(837);var c=h(n(840)),l=m(n(89)),s=m(n(0)),u=h(n(85)),f=n(264),d=h(n(842)),p=h(n(274));function m(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}function h(e){return e&&e.__esModule?e:{default:e}}function y(e){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function g(e,t,n,r,i,o,a){try{var c=e[o](a),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,i)}function b(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var o=e.apply(t,n);function a(e){g(o,r,i,a,c,"next",e)}function c(e){g(o,r,i,a,c,"throw",e)}a(void 0)})}}function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function O(e,t){return(O=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function P(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function E(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var S=["==================================================================================================","WARNING: Training may take several minutes depending on your hardware, your browser may be slow while training.","NOTE: Will train classification model, then NER model, then run the test dataset on both and finally download the trained models.","        The line-plotting of the training models will show at the end to avoid extra GPU/CPU load during training.","=================================================================================================="],_=u.default.div.withConfig({displayName:"TrainingDashboard__LoggerFeed",componentId:"eewm59-0"})(["white-space:pre-wrap;height:130px;overflow:scroll;background-color:#ededed;padding:10px 20px;margin-bottom:20px;display:flex;flex-direction:column-reverse;border:1px solid #ccc;font-size:12px;margin-bottom:20px;"]),j=function(e){function t(){var e,n,r,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,l=new Array(o),u=0;u<o;u++)l[u]=arguments[u];return r=this,i=(e=w(t)).call.apply(e,[this].concat(l)),n=!i||"object"!==y(i)&&"function"!=typeof i?P(r):i,E(P(P(n)),"state",{currentStep:0,logLinesCounter:0,pipelineFinishedTraining:!1,plot:!1,valuesClassification:[],valuesNer:[]}),E(P(P(n)),"pipeline",null),E(P(P(n)),"trainStatsClassification",[]),E(P(P(n)),"trainStatsNer",[]),E(P(P(n)),"renderPipelineManualTestInput",function(){return 3===n.state.currentStep&&n.pipeline?s.createElement(s.Fragment,null,s.createElement(c.default,{message:"Finished training! You can test sentences manually or look at the logs for stats.",type:"success",style:{marginBottom:20}}),s.createElement(p.default,{pipeline:n.pipeline})):null}),E(P(P(n)),"renderChart",function(e,t,r){if(!r.length||!t.length)return s.createElement(a.default,{title:e,style:{minHeight:"100%"}},s.createElement("p",null,"Waiting..."));var i="Batch ".concat(t.length," of ").concat(r[r.length-1].totalBatches),o=n.state.plot?s.createElement(d.default,{dataValues:t}):null;return s.createElement(a.default,{title:e,extra:i,style:{minHeight:"100%"}},o,s.createElement("p",{style:{fontSize:"12px"}},s.createElement("strong",null,"Train Accuracy:")," ",r[r.length-1].trainingAccuracy,s.createElement("br",null),s.createElement("strong",null,"Validation Accuracy:")," ",r[r.length-1].validationAccuracy,s.createElement("br",null),s.createElement("strong",null,"Train Loss:")," ",r[r.length-1].trainingLoss,s.createElement("br",null),s.createElement("strong",null,"Validation Loss:")," ",r[r.length-1].validationLoss,s.createElement("br",null)))}),E(P(P(n)),"trainStatsHandler",function(){return{classification:function(e){n.trainStatsClassification.push(e);var t=e.batch,r=e.validationLoss,i=e.trainingLoss;n.setState(function(e){return{valuesClassification:e.valuesClassification.concat([{batch:t,validationLoss:r,trainingLoss:i}])}})},ner:function(e){n.trainStatsNer.push(e);var t=e.batch,r=e.validationLoss,i=e.trainingLoss;n.setState(function(e){return{currentStep:0===e.currentStep?1:e.currentStep,valuesNer:e.valuesNer.concat([{batch:t,validationLoss:r,trainingLoss:i}])}})}}}),E(P(P(n)),"trainTestAndSaveModels",b(regeneratorRuntime.mark(function e(){var t,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r={debug:function(){return null},error:t=function(){S.push.apply(S,arguments),n.setState(function(e){return{logLinesCounter:e.logLinesCounter+1}})},log:t,warn:t},n.pipeline=new f.AidaPipeline({datasetParams:n.props.datasetParams,logger:r,ngramToIdDictionary:n.props.ngramToIdDictionary,pretrainedNGramVectors:n.props.pretrainedNGramVectors,trainStatsHandler:n.trainStatsHandler()}),n.pipeline){e.next=5;break}return e.abrupt("return",null);case 5:return e.next=7,n.pipeline.train(n.props.trainDataset);case 7:return n.setState({currentStep:2}),e.next=10,n.pipeline.test(n.props.testDataset);case 10:return i=e.sent,n.setState({currentStep:3}),r.log("=================================================================================================="),r.log("Test dataset stats:"),r.log(JSON.stringify(i,null,2)),r.log("=================================================================================================="),e.next=18,n.pipeline.save({classificationPath:"downloads://classification",embeddingPath:"downloads://embedding",nerPath:"downloads://ner"});case 18:n.setState({plot:!0});case 19:case"end":return e.stop()}},e,this)}))),n}var n,u,m;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&O(e,t)}(t,s.Component),n=t,(u=[{key:"componentDidMount",value:function(){this.trainTestAndSaveModels()}},{key:"componentWillUnmount",value:function(){this.pipeline=null,console.log(l.memory()),l.disposeVariables()}},{key:"render",value:function(){return s.createElement("div",null,s.createElement(o.default,{size:"small",current:this.state.currentStep,style:{marginBottom:"20px"}},s.createElement(o.default.Step,{title:"Train classification model"}),s.createElement(o.default.Step,{title:"Train NER model"}),s.createElement(o.default.Step,{title:"Test models"}),s.createElement(o.default.Step,{title:"Download and try"})),this.renderPipelineManualTestInput(),s.createElement("h3",{style:{marginTop:"20px"}},"Training logs:"),s.createElement(_,null,S.join("\n")),s.createElement(r.default,{type:"flex",justify:"center"},s.createElement(i.default,{span:12},this.renderChart("Classification model stats",this.state.valuesClassification,this.trainStatsClassification)),s.createElement(i.default,{span:12},this.renderChart("NER model stats",this.state.valuesNer,this.trainStatsNer))))}}])&&v(n.prototype,u),m&&v(n,m),t}();t.default=j},833:function(e,t,n){"use strict";n(87),n(834)},834:function(e,t,n){},836:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=p(n(64)),i=p(n(61)),o=p(n(65)),a=p(n(62)),c=p(n(63)),l=d(n(0)),s=d(n(2)),u=p(n(846)),f=p(n(84));function d(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function p(e){return e&&e.__esModule?e:{default:e}}var m=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return(0,c.default)(t,e),(0,o.default)(t,[{key:"render",value:function(){var e=this.props.prefixCls,t={finish:l.createElement(f.default,{type:"check",className:e+"-finish-icon"}),error:l.createElement(f.default,{type:"close",className:e+"-error-icon"})};return l.createElement(u.default,(0,r.default)({icons:t},this.props))}}]),t}(l.Component);t.default=m,m.Step=u.default.Step,m.defaultProps={prefixCls:"ant-steps",iconPrefix:"ant",current:0},m.propTypes={prefixCls:s.string,iconPrefix:s.string,current:s.number},e.exports=t.default},837:function(e,t,n){"use strict";n(87),n(838)},838:function(e,t,n){},840:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=y(n(64)),i=y(n(68)),o=y(n(61)),a=y(n(65)),c=y(n(62)),l=y(n(63)),s=h(n(0)),u=h(n(4)),f=y(n(207)),d=y(n(84)),p=y(n(67)),m=y(n(841));function h(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function y(e){return e&&e.__esModule?e:{default:e}}function g(){}var b=function(e){function t(e){(0,o.default)(this,t);var n=(0,c.default)(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleClose=function(e){e.preventDefault();var t=u.findDOMNode(n);t.style.height=t.offsetHeight+"px",t.style.height=t.offsetHeight+"px",n.setState({closing:!1}),(n.props.onClose||g)(e)},n.animationEnd=function(){n.setState({closed:!0,closing:!0}),(n.props.afterClose||g)()},n.state={closing:!0,closed:!1},n}return(0,l.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e,t=this.props,n=t.closable,o=t.description,a=t.type,c=t.prefixCls,l=void 0===c?"ant-alert":c,u=t.message,h=t.closeText,y=t.showIcon,g=t.banner,b=t.className,v=void 0===b?"":b,w=t.style,O=t.iconType;y=!(!g||void 0!==y)||y,a=g&&void 0===a?"warning":a||"info";var P="filled";if(!O){switch(a){case"success":O="check-circle";break;case"info":O="info-circle";break;case"error":O="close-circle";break;case"warning":O="exclamation-circle";break;default:O="default"}o&&(P="outlined")}var E=(0,p.default)(l,(e={},(0,i.default)(e,l+"-"+a,!0),(0,i.default)(e,l+"-close",!this.state.closing),(0,i.default)(e,l+"-with-description",!!o),(0,i.default)(e,l+"-no-icon",!y),(0,i.default)(e,l+"-banner",!!g),e),v);h&&(n=!0);var S=n?s.createElement("a",{onClick:this.handleClose,className:l+"-close-icon"},h||s.createElement(d.default,{type:"close"})):null,_=(0,m.default)(this.props),j=s.createElement(d.default,{className:l+"-icon",type:O,theme:P});return this.state.closed?null:s.createElement(f.default,{component:"",showProp:"data-show",transitionName:l+"-slide-up",onEnd:this.animationEnd},s.createElement("div",(0,r.default)({"data-show":this.state.closing,className:E,style:w},_),y?j:null,s.createElement("span",{className:l+"-message"},u),s.createElement("span",{className:l+"-description"},o),S))}}]),t}(s.Component);t.default=b,e.exports=t.default},841:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return Object.keys(e).reduce(function(t,n){return"data-"!==n.substr(0,5)&&"aria-"!==n.substr(0,5)&&"role"!==n||"data-__"===n.substr(0,7)||(t[n]=e[n]),t},{})},e.exports=t.default},842:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(n(0));function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a(this,c(t).apply(this,arguments))}var n,i,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(t,r.Component),n=t,(i=[{key:"render",value:function(){return r.createElement("div",null)}}])&&o(n.prototype,i),s&&o(n,s),t}();t.default=s},846:function(e,t,n){"use strict";n.r(t);var r=n(64),i=n.n(r),o=n(79),a=n.n(o),c=n(61),l=n.n(c),s=n(62),u=n.n(s),f=n(63),d=n.n(f),p=n(0),m=n.n(p),h=n(2),y=n.n(h),g=n(4),b=n(67),v=n.n(b),w=n(329),O=n.n(w);function P(){if("undefined"!=typeof window&&window.document&&window.document.documentElement){var e=window.document.documentElement;return"flex"in e.style||"webkitFlex"in e.style||"Flex"in e.style||"msFlex"in e.style}return!1}var E=function(e){function t(n){l()(this,t);var r=u()(this,e.call(this,n));return r.calcStepOffsetWidth=function(){if(!P()){var e=Object(g.findDOMNode)(r);e.children.length>0&&(r.calcTimeout&&clearTimeout(r.calcTimeout),r.calcTimeout=setTimeout(function(){var t=(e.lastChild.offsetWidth||0)+1;r.state.lastStepOffsetWidth===t||Math.abs(r.state.lastStepOffsetWidth-t)<=3||r.setState({lastStepOffsetWidth:t})}))}},r.state={flexSupported:!0,lastStepOffsetWidth:0},r.calcStepOffsetWidth=O()(r.calcStepOffsetWidth,150),r}return d()(t,e),t.prototype.componentDidMount=function(){this.calcStepOffsetWidth(),P()||this.setState({flexSupported:!1})},t.prototype.componentDidUpdate=function(){this.calcStepOffsetWidth()},t.prototype.componentWillUnmount=function(){this.calcTimeout&&clearTimeout(this.calcTimeout),this.calcStepOffsetWidth&&this.calcStepOffsetWidth.cancel&&this.calcStepOffsetWidth.cancel()},t.prototype.render=function(){var e,t=this.props,n=t.prefixCls,r=t.style,o=void 0===r?{}:r,c=t.className,l=t.children,s=t.direction,u=t.labelPlacement,f=t.iconPrefix,d=t.status,h=t.size,y=t.current,g=t.progressDot,b=t.initial,w=t.icons,O=a()(t,["prefixCls","style","className","children","direction","labelPlacement","iconPrefix","status","size","current","progressDot","initial","icons"]),P=this.state,E=P.lastStepOffsetWidth,S=P.flexSupported,_=m.a.Children.toArray(l).filter(function(e){return!!e}),j=_.length-1,x=g?"vertical":u,T=v()(n,n+"-"+s,c,((e={})[n+"-"+h]=h,e[n+"-label-"+x]="horizontal"===s,e[n+"-dot"]=!!g,e));return m.a.createElement("div",i()({className:T,style:o},O),p.Children.map(_,function(e,t){if(!e)return null;var r=b+t,a=i()({stepNumber:""+(r+1),prefixCls:n,iconPrefix:f,wrapperStyle:o,progressDot:g,icons:w},e.props);return S||"vertical"===s||t===j||(a.itemWidth=100/j+"%",a.adjustMarginRight=-Math.round(E/j+1)),"error"===d&&t===y-1&&(a.className=n+"-next-error"),e.props.status||(a.status=r===y?d:r<y?"finish":"wait"),Object(p.cloneElement)(e,a)}))},t}(p.Component);E.propTypes={prefixCls:y.a.string,className:y.a.string,iconPrefix:y.a.string,direction:y.a.string,labelPlacement:y.a.string,children:y.a.any,status:y.a.string,size:y.a.string,progressDot:y.a.oneOfType([y.a.bool,y.a.func]),style:y.a.object,initial:y.a.number,current:y.a.number,icons:y.a.shape({finish:y.a.node,error:y.a.node})},E.defaultProps={prefixCls:"rc-steps",iconPrefix:"rc",direction:"horizontal",labelPlacement:"horizontal",initial:0,current:0,status:"process",size:"",progressDot:!1};var S=E;function _(e){return"string"==typeof e}var j=function(e){function t(){return l()(this,t),u()(this,e.apply(this,arguments))}return d()(t,e),t.prototype.renderIconNode=function(){var e,t=this.props,n=t.prefixCls,r=t.progressDot,i=t.stepNumber,o=t.status,a=t.title,c=t.description,l=t.icon,s=t.iconPrefix,u=t.icons,f=v()(n+"-icon",s+"icon",((e={})[s+"icon-"+l]=l&&_(l),e[s+"icon-check"]=!l&&"finish"===o&&u&&!u.finish,e[s+"icon-close"]=!l&&"error"===o&&u&&!u.error,e)),d=m.a.createElement("span",{className:n+"-icon-dot"});return r?"function"==typeof r?m.a.createElement("span",{className:n+"-icon"},r(d,{index:i-1,status:o,title:a,description:c})):m.a.createElement("span",{className:n+"-icon"},d):l&&!_(l)?m.a.createElement("span",{className:n+"-icon"},l):u&&u.finish&&"finish"===o?m.a.createElement("span",{className:n+"-icon"},u.finish):u&&u.error&&"error"===o?m.a.createElement("span",{className:n+"-icon"},u.error):l||"finish"===o||"error"===o?m.a.createElement("span",{className:f}):m.a.createElement("span",{className:n+"-icon"},i)},t.prototype.render=function(){var e,t=this.props,n=t.className,r=t.prefixCls,o=t.style,c=t.itemWidth,l=t.status,s=void 0===l?"wait":l,u=(t.iconPrefix,t.icon),f=(t.wrapperStyle,t.adjustMarginRight),d=(t.stepNumber,t.description),p=t.title,h=(t.progressDot,t.tailContent),y=(t.icons,a()(t,["className","prefixCls","style","itemWidth","status","iconPrefix","icon","wrapperStyle","adjustMarginRight","stepNumber","description","title","progressDot","tailContent","icons"])),g=v()(r+"-item",r+"-item-"+s,n,((e={})[r+"-item-custom"]=u,e)),b=i()({},o);return c&&(b.width=c),f&&(b.marginRight=f),m.a.createElement("div",i()({},y,{className:g,style:b}),m.a.createElement("div",{className:r+"-item-tail"},h),m.a.createElement("div",{className:r+"-item-icon"},this.renderIconNode()),m.a.createElement("div",{className:r+"-item-content"},m.a.createElement("div",{className:r+"-item-title"},p),d&&m.a.createElement("div",{className:r+"-item-description"},d)))},t}(m.a.Component);j.propTypes={className:y.a.string,prefixCls:y.a.string,style:y.a.object,wrapperStyle:y.a.object,itemWidth:y.a.oneOfType([y.a.number,y.a.string]),status:y.a.string,iconPrefix:y.a.string,icon:y.a.node,adjustMarginRight:y.a.oneOfType([y.a.number,y.a.string]),stepNumber:y.a.string,description:y.a.any,title:y.a.any,progressDot:y.a.oneOfType([y.a.bool,y.a.func]),tailContent:y.a.any,icons:y.a.shape({finish:y.a.node,error:y.a.node})};var x=j;n.d(t,"Step",function(){return x}),S.Step=x;t.default=S}}]);
//# sourceMappingURL=component---web-pages-train-tsx-9a963d99e1f8467b717d.js.map